<div class="reels-container">
  <!-- Sidebar izquierdo estilo TikTok -->
  <aside class="sidebar-left">
    <div class="logo-section">
      <div class="logo-icon">ğŸ³</div>
      <h1 class="logo-text">GastroGuide</h1>
    </div>
    
    <div class="search-box">
      <span class="search-icon">ğŸ”</span>
      <input type="text" placeholder="Buscar" class="search-input" />
    </div>

    <nav class="nav-menu">
      <button class="nav-item active">
        <span class="nav-icon">ğŸ </span>
        <span class="nav-label">Para ti</span>
      </button>
      <button class="nav-item">
        <span class="nav-icon">ğŸ‘¥</span>
        <span class="nav-label">Siguiendo</span>
      </button>
      <button class="nav-item" (click)="showForm = !showForm">
        <span class="nav-icon">â•</span>
        <span class="nav-label">Cargar</span>
      </button>
      <button class="nav-item">
        <span class="nav-icon">ğŸ‘¤</span>
        <span class="nav-label">Perfil</span>
      </button>
      
    </nav>

    <button class="login-btn">Iniciar sesiÃ³n</button>

    <div class="sidebar-footer">
      <a href="#">Company</a>
      <a href="#">Program</a>
      <a href="#">Terms & Policies</a>
      <p>Â© 2025 GastroGuide</p>
    </div>

    <!-- Formulario temporal para agregar reels -->
    <div class="upload-form" *ngIf="showForm">
      <h3>Agregar Reel (Manual)</h3>
      <form (ngSubmit)="addReel()">
        <input type="text" placeholder="TÃ­tulo" [(ngModel)]="newReel.title" name="title" required />
        <input type="text" placeholder="URL del video" [(ngModel)]="newReel.src" name="src" required />
        <button type="submit" class="submit-btn">Guardar</button>
      </form>
      <!-- TODO: Reemplazar con lÃ³gica de upload real -->
    </div>
  </aside>

  <!-- Ãrea principal del video -->
  <main class="video-feed" *ngIf="current as reel">
    <div class="video-container">
      <div class="video-frame">
        <video 
          #videoPlayer
          [src]="reel.src" 
          autoplay 
          loop 
          playsinline
          class="main-video"
          (timeupdate)="onVideoTimeUpdate($event)"
        ></video>

      <!-- InformaciÃ³n overlay en la parte inferior -->
      <div class="video-info-overlay">
        <div class="author-section">
          <div class="author-avatar">
            <img [src]="'https://ui-avatars.com/api/?name=' + reel.author + '&background=FF6028&color=fff'" alt="Avatar" />
          </div>
          <div class="author-details">
            <h3 class="author-name">{{ reel.author }}</h3>
            <p class="video-caption">{{ reel.title }}</p>
            <div class="video-tags">
              <span class="tag">#legend</span>
              <span class="tag">#trendin</span>
              <span class="more-link">... mÃ¡s</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Controles superiores estilo TikTok -->
      <div class="top-controls">
        <button class="ctrl-icon-btn play-btn" (click)="togglePlay()" aria-label="Play/Pause" [class.playing]="isPlaying">
          <!-- SVG icon: switches visually with CSS by toggling .playing on the button -->
          <svg class="play-svg" viewBox="0 0 64 64" aria-hidden="true">
            <defs>
              <linearGradient id="g1" x1="0" x2="1">
                <stop offset="0" stop-color="#FF6028"/>
                <stop offset="1" stop-color="#FB8C71"/>
              </linearGradient>
            </defs>
            <!-- play triangle -->
            <g class="icon-play">
              <path d="M22 16 L50 32 L22 48 Z" fill="url(#g1)" />
            </g>
            <!-- pause bars -->
            <g class="icon-pause" fill="url(#g1)">
              <rect x="20" y="16" width="8" height="32" rx="2" />
              <rect x="36" y="16" width="8" height="32" rx="2" />
            </g>
          </svg>
        </button>
        <button class="ctrl-icon-btn mute-btn" (click)="toggleMute()" aria-label="Mute/Unmute" [class.muted]="isMuted">
          <!-- SVG for mute/unmute: icon switches by toggling .muted on the button -->
          <svg class="mute-svg" viewBox="0 0 64 64" aria-hidden="true">
            <!-- unmuted: speaker + waves -->
            <g class="icon-unmuted" fill="#fff" opacity="0.95">
              <path d="M14 26v12c0 1.1.9 2 2 2h6l10 8V16L22 26h-6c-1.1 0-2 .9-2 2z" />
              <path class="wave1" d="M44 24c1.5 2 2.4 4.5 2.4 7s-.9 5-2.4 7" stroke="#fff" stroke-width="2" stroke-linecap="round" fill="none" opacity="0.9"/>
              <path class="wave2" d="M48 20c3 4 4.8 8.6 4.8 14s-1.8 10-4.8 14" stroke="#fff" stroke-width="2" stroke-linecap="round" fill="none" opacity="0.75"/>
            </g>
            <!-- muted: speaker with cross -->
            <g class="icon-muted" fill="#fff" opacity="0">
              <path d="M14 26v12c0 1.1.9 2 2 2h6l10 8V16L22 26h-6c-1.1 0-2 .9-2 2z" />
              <g stroke="#fff" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                <path d="M44 20 L52 28 M52 20 L44 28" />
              </g>
            </g>
          </svg>
        </button>
      </div>

      <!-- Barra de progreso (solo visible al hover sobre el video) -->
      <div class="progress-wrapper">
        <div class="progress-inner">
          <input
            type="range"
            min="0"
            max="100"
            step="0.1"
            class="progress-bar"
            [value]="seekValue"
            (input)="onSeek($event)"
            aria-label="Barra de progreso del video"
          />
          <div class="progress-times">
            <span class="time current">{{ formatTime(currentTime) }}</span>
            <span class="time sep">/</span>
            <span class="time total">{{ formatTime(duration) }}</span>
          </div>
        </div>
      </div>
      </div><!-- .video-frame -->
      <!-- NavegaciÃ³n por scroll o gestos: flechas removidas -->
    </div>
  </main>

  <!-- Barra de acciones derecha -->
  <aside class="actions-sidebar" *ngIf="current as reel">
    <!-- Avatar del autor con botÃ³n follow -->
    <div class="action-item author-action">
      <div class="action-avatar">
        <img [src]="'https://ui-avatars.com/api/?name=' + reel.author + '&background=FF6028&color=fff'" alt="Avatar" />
        <button class="follow-btn">+</button>
      </div>
    </div>

    <!-- BotÃ³n de like -->
    <button class="action-item" [class.liked]="reel.liked" (click)="toggleLike(reel)">
      <div class="action-icon">â¤ï¸</div>
      <span class="action-count">{{ reel.likes >= 1000 ? (reel.likes/1000 | number:'1.0-1') + 'M' : reel.likes }}</span>
    </button>

    <!-- BotÃ³n de comentarios -->
    <button class="action-item" (click)="toggleCommentsPanel()">
      <div class="action-icon">ğŸ’¬</div>
      <span class="action-count">{{ reel.comments >= 1000 ? (reel.comments/1000 | number:'1.0-1') + 'K' : reel.comments }}</span>
    </button>

    <!-- BotÃ³n de guardados -->
    <button class="action-item">
      <div class="action-icon">ğŸ”–</div>
      <span class="action-count">{{ reel.saves >= 1000 ? (reel.saves/1000 | number:'1.0-1') + 'K' : reel.saves }}</span>
    </button>

    <!-- BotÃ³n de compartir -->
    <button class="action-item">
      <div class="action-icon">â†—ï¸</div>
      <span class="action-count">{{ reel.shares >= 1000 ? (reel.shares/1000 | number:'1.0-1') + 'K' : reel.shares }}</span>
    </button>
  </aside>
  <!-- Panel de comentarios -->
  <div class="comments-panel" *ngIf="showComments && current as reel">
    <div class="cp-header">
      <h3>Comentarios</h3>
      <button class="cp-close" (click)="toggleCommentsPanel()">Ã—</button>
    </div>
    <div class="cp-body">
      <div class="comment-item" *ngFor="let c of reel.commentList">{{ c.text }} <span class="date">{{ c.createdAt | date:'shortTime' }}</span></div>
      <div *ngIf="!reel.commentList || reel.commentList.length === 0" class="empty">SÃ© el primero en comentar.</div>
    </div>
    <form class="cp-form" (ngSubmit)="submitComment(reel)">
      <input type="text" [(ngModel)]="newCommentText" name="comment" placeholder="Escribe un comentario..." autocomplete="off" />
      <button type="submit" [disabled]="!newCommentText.trim()">Enviar</button>
    </form>
  </div>
</div>